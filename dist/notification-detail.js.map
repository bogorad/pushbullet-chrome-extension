{
  "version": 3,
  "sources": ["../src/lib/ui/dom.ts", "../src/notification-detail/index.ts"],
  "sourcesContent": ["/**\r\n * DOM manipulation utilities for UI pages\r\n */\r\n\r\n/**\r\n * Safely get an element by ID with type checking\r\n */\r\nexport function getElementById<T extends HTMLElement>(id: string): T {\r\n  const element = document.getElementById(id);\r\n  if (!element) {\r\n    throw new Error(`Element with id \"${id}\" not found`);\r\n  }\r\n  return element as T;\r\n}\r\n\r\n/**\r\n * Safely query selector with type checking\r\n */\r\nexport function querySelector<T extends Element>(selector: string): T {\r\n  const element = document.querySelector(selector);\r\n  if (!element) {\r\n    throw new Error(`Element with selector \"${selector}\" not found`);\r\n  }\r\n  return element as T;\r\n}\r\n\r\n/**\r\n * Show an element\r\n */\r\nexport function show(element: HTMLElement): void {\r\n  element.style.display = '';\r\n}\r\n\r\n/**\r\n * Hide an element\r\n */\r\nexport function hide(element: HTMLElement): void {\r\n  element.style.display = 'none';\r\n}\r\n\r\n/**\r\n * Toggle element visibility\r\n */\r\nexport function toggle(element: HTMLElement): void {\r\n  if (element.style.display === 'none') {\r\n    show(element);\r\n  } else {\r\n    hide(element);\r\n  }\r\n}\r\n\r\n/**\r\n * Set text content safely\r\n */\r\nexport function setText(element: HTMLElement, text: string): void {\r\n  element.textContent = text;\r\n}\r\n\r\n/**\r\n * Set HTML content safely (sanitized)\r\n */\r\nexport function setHTML(element: HTMLElement, html: string): void {\r\n  // Basic sanitization - remove script tags\r\n  const sanitized = html.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '');\r\n  element.innerHTML = sanitized;\r\n}\r\n\r\n/**\r\n * Add event listener with type safety\r\n */\r\nexport function on<K extends keyof HTMLElementEventMap>(\r\n  element: HTMLElement,\r\n  event: K,\r\n  handler: (this: HTMLElement, ev: HTMLElementEventMap[K]) => void\r\n): void {\r\n  element.addEventListener(event, handler);\r\n}\r\n\r\n/**\r\n * Format timestamp for display\r\n */\r\nexport function formatTimestamp(date: Date): string {\r\n  const now = new Date();\r\n  const diff = now.getTime() - date.getTime();\r\n  const seconds = Math.floor(diff / 1000);\r\n  const minutes = Math.floor(seconds / 60);\r\n  const hours = Math.floor(minutes / 60);\r\n  const days = Math.floor(hours / 24);\r\n\r\n  if (seconds < 60) {\r\n    return 'just now';\r\n  } else if (minutes < 60) {\r\n    return `${minutes}m ago`;\r\n  } else if (hours < 24) {\r\n    return `${hours}h ago`;\r\n  } else if (days < 7) {\r\n    return `${days}d ago`;\r\n  } else {\r\n    return date.toLocaleDateString();\r\n  }\r\n}\r\n\r\n/**\r\n * Show status message\r\n */\r\nexport function showStatus(element: HTMLElement, message: string, type: 'success' | 'error' | 'info' = 'info'): void {\r\n  element.textContent = message;\r\n  element.className = `status-message status-${type}`;\r\n  show(element);\r\n  \r\n  // Auto-hide after 3 seconds\r\n  setTimeout(() => {\r\n    hide(element);\r\n  }, 3000);\r\n}\r\n\r\n/**\r\n * Clear all children of an element\r\n */\r\nexport function clearChildren(element: HTMLElement): void {\r\n  while (element.firstChild) {\r\n    element.removeChild(element.firstChild);\r\n  }\r\n}\r\n\r\n", "/**\r\n * Notification detail page\r\n */\r\n\r\nimport type { Push } from '../types/domain';\r\nimport { getElementById, querySelector, setText } from '../lib/ui/dom';\r\n\r\nlet pushData: Push | null = null;\r\n\r\n/**\r\n * Get notification ID from URL\r\n */\r\nfunction getNotificationId(): string | null {\r\n  const urlParams = new URLSearchParams(window.location.search);\r\n  return urlParams.get('id');\r\n}\r\n\r\n/**\r\n * Load notification data from background\r\n */\r\nfunction loadNotification(): void {\r\n  const notificationId = getNotificationId();\r\n  \r\n  if (!notificationId) {\r\n    const messageEl = getElementById<HTMLDivElement>('message');\r\n    setText(messageEl, 'No notification ID provided');\r\n    return;\r\n  }\r\n\r\n  // Request notification data from background\r\n  chrome.runtime.sendMessage({\r\n    action: 'getNotificationData',\r\n    notificationId: notificationId\r\n  }, (response: { success: boolean; push?: Push; error?: string }) => {\r\n    if (response && response.push) {\r\n      pushData = response.push;\r\n      displayNotification(pushData);\r\n    } else {\r\n      const messageEl = getElementById<HTMLDivElement>('message');\r\n      setText(messageEl, 'Notification not found');\r\n    }\r\n  });\r\n}\r\n\r\n/**\r\n * Display notification data\r\n */\r\nfunction displayNotification(push: Push): void {\r\n  const titleEl = getElementById<HTMLHeadingElement>('title');\r\n  const messageEl = getElementById<HTMLDivElement>('message');\r\n  const typeBadgeEl = getElementById<HTMLSpanElement>('type-badge');\r\n  const timestampEl = getElementById<HTMLSpanElement>('timestamp');\r\n  const sourceEl = getElementById<HTMLSpanElement>('source');\r\n\r\n  // Extract title and message based on push type\r\n  let title = 'Push';\r\n  let message = '';\r\n  let type = push.type || 'unknown';\r\n\r\n  if (push.type === 'note') {\r\n    title = push.title || 'Note';\r\n    message = push.body || '';\r\n  } else if (push.type === 'link') {\r\n    title = push.title || 'Link';\r\n    message = push.url || '';\r\n  } else if (push.type === 'file') {\r\n    title = push.file_name || 'File';\r\n    message = push.body || push.file_url || '';\r\n  } else if (push.type === 'mirror') {\r\n    title = push.title || push.application_name || 'Notification';\r\n    message = push.body || '';\r\n  } else if (push.type === 'sms_changed') {\r\n    if (push.notifications && push.notifications.length > 0) {\r\n      const sms = push.notifications[0];\r\n      title = sms.title || 'SMS';\r\n      message = sms.body || '';\r\n    } else {\r\n      title = 'SMS';\r\n      message = 'New SMS received';\r\n    }\r\n    type = 'sms';\r\n  } else {\r\n    title = 'Push';\r\n    message = JSON.stringify(push, null, 2);\r\n  }\r\n\r\n  setText(titleEl, title);\r\n  setText(messageEl, message);\r\n  setText(typeBadgeEl, type.toUpperCase());\r\n\r\n  // Set timestamp\r\n  if (push.created) {\r\n    const date = new Date(push.created * 1000);\r\n    setText(timestampEl, date.toLocaleString());\r\n  }\r\n\r\n  // Set source\r\n  if (push.source_device_iden) {\r\n    setText(sourceEl, 'From device');\r\n  } else {\r\n    setText(sourceEl, 'Pushbullet');\r\n  }\r\n\r\n  // Check for 6-digit verification code\r\n  detectVerificationCode(title, message);\r\n}\r\n\r\n/**\r\n * Detect 6-digit verification code\r\n */\r\nfunction detectVerificationCode(title: string, message: string): void {\r\n  const fullText = (title + ' ' + message).toLowerCase();\r\n\r\n  // Check if text contains \"code\" keyword\r\n  if (!fullText.includes('code')) {\r\n    return;\r\n  }\r\n\r\n  // Look for 6-digit number\r\n  const codeMatch = (title + ' ' + message).match(/\\b(\\d{6})\\b/);\r\n\r\n  if (codeMatch) {\r\n    const code = codeMatch[1];\r\n\r\n    // Create code copy button\r\n    const actionsDiv = querySelector<HTMLDivElement>('.actions');\r\n    const codeBtn = document.createElement('button');\r\n    codeBtn.className = 'btn-code';\r\n    codeBtn.innerHTML = `\uD83D\uDCCB Copy Code: <strong>${code}</strong>`;\r\n    codeBtn.onclick = () => copyCode(code);\r\n\r\n    // Insert as first button\r\n    actionsDiv.insertBefore(codeBtn, actionsDiv.firstChild);\r\n  }\r\n}\r\n\r\n/**\r\n * Copy verification code\r\n */\r\nfunction copyCode(code: string): void {\r\n  navigator.clipboard.writeText(code).then(() => {\r\n    // Show feedback\r\n    const feedback = getElementById<HTMLDivElement>('copy-feedback');\r\n    setText(feedback, `\u2713 Code ${code} copied!`);\r\n    feedback.classList.add('show');\r\n    setTimeout(() => {\r\n      feedback.classList.remove('show');\r\n    }, 2000);\r\n  }).catch((err) => {\r\n    console.error('Failed to copy code:', err);\r\n    alert('Failed to copy code to clipboard');\r\n  });\r\n}\r\n\r\n/**\r\n * Copy text to clipboard\r\n */\r\nfunction copyToClipboard(): void {\r\n  const messageEl = getElementById<HTMLDivElement>('message');\r\n  const text = messageEl.textContent || '';\r\n\r\n  navigator.clipboard.writeText(text).then(() => {\r\n    // Show feedback\r\n    const feedback = getElementById<HTMLDivElement>('copy-feedback');\r\n    feedback.classList.add('show');\r\n    setTimeout(() => {\r\n      feedback.classList.remove('show');\r\n    }, 2000);\r\n  }).catch((err) => {\r\n    console.error('Failed to copy:', err);\r\n    alert('Failed to copy to clipboard');\r\n  });\r\n}\r\n\r\n/**\r\n * Close window\r\n */\r\nfunction closeWindow(): void {\r\n  window.close();\r\n}\r\n\r\n/**\r\n * Initialize page\r\n */\r\nfunction init(): void {\r\n  // Event listeners\r\n  const copyBtn = getElementById<HTMLButtonElement>('copy-btn');\r\n  const closeBtn = getElementById<HTMLButtonElement>('close-btn');\r\n  \r\n  copyBtn.addEventListener('click', copyToClipboard);\r\n  closeBtn.addEventListener('click', closeWindow);\r\n\r\n  // Load notification\r\n  loadNotification();\r\n}\r\n\r\n// Initialize on DOM load\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', init);\r\n} else {\r\n  init();\r\n}\r\n\r\n"],
  "mappings": "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",
  "names": []
}
